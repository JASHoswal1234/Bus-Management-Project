{% extends "base.html" %}

{% block title %}Daily Schedules Report - Bus Depot Management{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 style="color: #007bff; border-left: 5px solid #007bff; padding-left: 15px;">
            <i class="bi bi-calendar-check"></i> Daily Schedules Report
        </h2>
        <p class="text-muted ms-3">Report generated on {{ report_date.strftime('%Y-%m-%d') }}</p>
    </div>
    <div>
        <a href="{{ url_for('reports.daily_schedules_csv') }}" class="btn btn-success me-2">
            <i class="bi bi-file-earmark-spreadsheet"></i> Export to CSV
        </a>
        <a href="{{ url_for('reports.daily_schedules_pdf') }}" class="btn btn-danger me-2">
            <i class="bi bi-file-earmark-pdf"></i> Export to PDF
        </a>
        <a href="{{ url_for('reports.index') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Back
        </a>
    </div>
</div>

{% if schedules %}
<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead class="table-light">
            <tr>
                <th>Route</th>
                <th>Bus</th>
                <th>Departure Time</th>
                <th>Arrival Time</th>
                <th>Frequency</th>
                <th>Assigned Crew</th>
            </tr>
        </thead>
        <tbody>
            {% for schedule in schedules %}
            <tr>
                <td><strong>{{ schedule.route.route_name }}</strong></td>
                <td>{{ schedule.bus.registration_number }}</td>
                <td>{{ schedule.departure_time.strftime('%H:%M') }}</td>
                <td>{{ schedule.arrival_time.strftime('%H:%M') }}</td>
                <td>{{ schedule.frequency.capitalize() }}</td>
                <td>
                    {% set crew_list = schedule.crew_assignments %}
                    {% if crew_list %}
                        {% for assignment in crew_list %}
                            <span class="badge bg-info">{{ assignment.crew_member.name }} ({{ assignment.crew_member.role }})</span>
                        {% endfor %}
                    {% else %}
                        <span class="text-muted">No crew assigned</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="alert alert-info text-center">
    <i class="bi bi-info-circle fs-2"></i>
    <p class="mt-2 mb-0">No active schedules found.</p>
</div>
{% endif %}
{% endblock %}
